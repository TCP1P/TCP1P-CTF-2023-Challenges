A CBC padding oracle attack (https://en.wikipedia.org/wiki/Padding_oracle_attack) that allow attacker to decrypt ciphertext based on error message generated by padding validation, without knowing the encryption key

Summary:
Flag is given if user can enter the "nottheflagbutstillcrucialvalidation", encrypted with system's key. Meanwhile user can retrieve current admin's encrypted password and change it too. The problem is user can't decrypt the encrypted password and if they can, they still can't login because the encrypted is not "nottheflagbutstillcrucialvalidation". Important thing to notes is the pad() and unpad() function are customized, and incorrect padding will make the system notify that something's wrong. This could result in CBC padding oracle vulnerability.

Attack idea:
1. With CBC oracle padding vulnerability, user can abuse it to decrypt the admin initial key, then use byte flipping to change the key into "nottheflagbutstillcrucialvalidation" (let's call this validation key) and get the flag.
2. Retrieve admin initial key by bruteforcing the login page, manipulate the payload per character and validate it using the incorrect padding message.
2. Once we get the initial key, use byte flipping to flip every blocks of the initial key into validation key. We can solve the broken blocks problem by once again, utilizing the CBC oracle padding attack that we used before.
3. Do it repeatedly until very first block, then enter the encrypted payload.
4. Flag!

reference (this might help): https://blog.soreatu.com/posts/writeup-for-web-checkin-in-cybrics-ctf-2021/